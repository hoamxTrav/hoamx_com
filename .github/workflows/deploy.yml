name: Firebase Hosting CI/CD

on:
  push:
    branches: [ main ]
  pull_request:
    types: [opened, synchronize, reopened, closed]
    branches: [ main ]

jobs:
  build_and_deploy:
    # Same logic as your Azure job: run on push, or on PR events except closed
    if: github.event_name == 'push' || (github.event_name == 'pull_request' && github.event.action != 'closed')
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # No npm / no build for now – static site from root per firebase.json
      # If you add a build later, we can insert npm steps here.

      - name: Deploy to Firebase Hosting
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: ${{ secrets.GITHUB_TOKEN }}
          token: ${{ secrets.FIREBASE_TOKEN }}
          channelId: live
          projectId: hoamx1   # <- make sure this matches your Firebase project ID

  # Optional: a separate job for PR previews (not required)
  # For now, we skip a "close_pr" equivalent – Firebase preview channels auto-expire.
